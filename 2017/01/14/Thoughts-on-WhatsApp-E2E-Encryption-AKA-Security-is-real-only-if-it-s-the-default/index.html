<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Thoughts on WhatsApp E2E Encryption AKA Security Is Real Only if It&#39;s the Default. | evilsocket / Simone</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Yesterday Tobias Boelter posted on his blog this article which essentially highlights a message rentransmission vulnerability on WhatsApp which makes it leak sensitive information if the recipient’s k">
<meta name="keywords" content="privacy,whatsapp,end to end encryption,the guardian,backdoor">
<meta property="og:type" content="article">
<meta property="og:title" content="Thoughts on WhatsApp E2E Encryption AKA Security Is Real Only if It&#39;s the Default.">
<meta property="og:url" content="https://www.evilsocket.net/2017/01/14/Thoughts-on-WhatsApp-E2E-Encryption-AKA-Security-is-real-only-if-it-s-the-default/index.html">
<meta property="og:site_name" content="evilsocket &#x2F; Simone">
<meta property="og:description" content="Yesterday Tobias Boelter posted on his blog this article which essentially highlights a message rentransmission vulnerability on WhatsApp which makes it leak sensitive information if the recipient’s k">
<meta property="og:image" content="https://whispersystems.org/blog/images/whatsapp-keychange.png">
<meta property="og:updated_time" content="2017-08-11T14:28:47.043Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Thoughts on WhatsApp E2E Encryption AKA Security Is Real Only if It&#39;s the Default.">
<meta name="twitter:description" content="Yesterday Tobias Boelter posted on his blog this article which essentially highlights a message rentransmission vulnerability on WhatsApp which makes it leak sensitive information if the recipient’s k">
<meta name="twitter:image" content="https://whispersystems.org/blog/images/whatsapp-keychange.png">
<meta name="twitter:creator" content="@evilsocket">
<link rel="publisher" href="https://plus.google.com/104794390596458308819">

  <meta name="google-site-verification" content="6qdVG0z0lac2ceITCoTCNm15CPp3K9Sq41_5IK4OLKM">

  
    <link rel="alternate" href="/atom.xml" title="evilsocket / Simone" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-22026549-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
  <script type="text/javascript" src="https://blockchain.info/Resources/js/pay-now-button.js"></script>
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">evilsocket / Simone</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">I hack stuff.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/books.html">Books</a>
        
          <a class="main-nav-link" href="/random-facts-about-me.html">About Me</a>
        
      </nav>
      <nav id="sub-nav">
        <a id="nav-github-link" class="nav-icon" href="https://github.com/evilsocket" target="_blank"></a>
        <a id="nav-linkedin-link" class="nav-icon" href="http://it.linkedin.com/in/simonemargaritelli/" target="_blank"></a>
        <a id="nav-twitter-link" class="nav-icon" href="https://twitter.com/evilsocket" target="_blank"></a>
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://www.evilsocket.net"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Thoughts-on-WhatsApp-E2E-Encryption-AKA-Security-is-real-only-if-it-s-the-default" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Thoughts on WhatsApp E2E Encryption AKA Security Is Real Only if It&#39;s the Default.
    </h1>
  

      </header>
    
    <br/>
    <div class="article-meta">
      Posted on <time datetime="2017-01-14T19:10:02.000Z" itemprop="datePublished">2017-01-14</time>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <br/>
        <div class="addthis_sharing_toolbox"></div>
        <p>Yesterday <a href="https://twitter.com/tobiasboelter" target="_blank" rel="external">Tobias Boelter</a> posted on his blog <a href="https://tobi.rocks/2017/01/whatsapp-vulnerability-bug-or-backdoor/" target="_blank" rel="external">this article</a> which essentially highlights a message rentransmission vulnerability on WhatsApp which makes it leak sensitive information if the recipient’s key changed, only alerting the user <strong>after</strong> the message has been sent.<br>The Guardian has then picked up the info and posted the article “<a href="https://www.theguardian.com/technology/2017/jan/13/whatsapp-backdoor-allows-snooping-on-encrypted-messages" target="_blank" rel="external">WhatsApp vulnerability allows snooping on encrypted messages</a>“. </p>
<p>In a matter of hours, a shit load of experts (and unfortunately also lot of ppl who are <strong>not</strong> experts at all) pointed their fingers at The Guardian, arguing that it’s not a backdoor and all other kind of sterile polemics. At some point, Moxie from Open Whisper Systems, the noprofit organization who made <strong>Signal</strong>, the only really secure messaging app we’re aware of <strong>and</strong> the library that WhatsApp recently integrated in order to give E2E encrypted messaging to all of their users, published on the blog this: “<a href="https://whispersystems.org/blog/there-is-no-whatsapp-backdoor/" target="_blank" rel="external">There is no WhatsApp ‘backdoor’</a>“, which <strong>seemed</strong> to have put the word END to this conversation.</p>
<p>I do not agree and, since a lot of <strong>ego</strong> is going on here, I’d like to share my thoughts as well.</p>
<a id="more"></a>
<center><br><blockquote class="twitter-tweet" data-lang="it"><p lang="en" dir="ltr">.<a href="https://twitter.com/guardian" target="_blank" rel="external">@guardian</a> Pathetically, everyone who jumped to trumpet my tweets of a Telegram weakness will ignore this because WhatsApp staff stroked the right egos</p>&mdash; Nadim Kobeissi (@kaepora) <a href="https://twitter.com/kaepora/status/819893937934434304" target="_blank" rel="external">13 gennaio 2017</a></blockquote><br><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><br></center>

<p>First thing first, following the <strong>PoC||GTFO</strong> sacrosanct principle, let’s take a look at the video that Tobias recently uploaded.</p>
<center><br>    <iframe width="100%" height="315" src="https://www.youtube.com/embed/we-pJE5JjAs" frameborder="0" allowfullscreen></iframe><br></center>

<p>In the video Tobias just swapped the SIM card to the other phone to prove his point, but it’s quite clear that from a state sponsored attacker perspective, physical access to the sim card or the victim’s phone is not needed at all, there are plenty of easier ways for them to do that ( pretty much like <a href="https://lists.cpunks.org/pipermail/cypherpunks/2016-April/012958.html" target="_blank" rel="external">Russia did with SS7 &amp; Telegram users</a> ).</p>
<p>Long story short, if WhatsApp technicians manage to replace your recipient E2E encryption key on the server side and impersonate him (or manage to clone his sim on the TELCO side), <strong>your sensitive message will be sent anyway</strong>, the client will show you just a warning about the key change, but nevertheless, let’s say it again, <strong>your sensitive message will be sent anyway</strong> … and they’ll be able to read it, <strong>period</strong>.</p>
<center><br>    <img width="250" src="https://whispersystems.org/blog/images/whatsapp-keychange.png"><br></center>

<p>On the other hand, <a href="https://play.google.com/store/apps/details?id=org.thoughtcrime.securesms" target="_blank" rel="external">Signal</a> prevents this from happening, once it’ll detect the key being changed, it will <strong>block</strong> the conversation and warn the user about it, it’ll be the user then to decide if trusting the new key or not, regardless, <strong>the sensitive contents won’t be rentransmitted without the user allowing it</strong>, this is a subtle but very important detail.</p>
<h3 id="But-it’s-just-a-matter-of-settings"><a href="#But-it’s-just-a-matter-of-settings" class="headerlink" title="But it’s just a matter of settings!"></a>But it’s just a matter of settings!</h3><center><br><blockquote class="twitter-tweet" data-lang="it"><p lang="en" dir="ltr">quoting mr <a href="https://twitter.com/csoghoian" target="_blank" rel="external">@csoghoian</a>, this sentence quite fits in this whole WhatsApp / Guardian / <a href="https://twitter.com/whispersystems" target="_blank" rel="external">@whispersystems</a> discussion <a href="https://t.co/DHEnmYqRrw" target="_blank" rel="external">pic.twitter.com/DHEnmYqRrw</a></p>&mdash; Simone Margaritelli (@evilsocket) <a href="https://twitter.com/evilsocket/status/820100621898547201" target="_blank" rel="external">14 gennaio 2017</a></blockquote><br><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><br></center>

<p>Yes, they <strong>do</strong> implement the same protocol and <strong>no</strong>, we don’t have any real evidence that Facebook messed with it, <strong>still</strong> they created (either intentionally or not) a very serious security vulnerability for their users.</p>
<p>And it’s exactly about <strong>intentionality</strong> we’re talking about, if it was intentionally implelemented to spy on users <strong>it’s a backdoor</strong>, otherwise <strong>it’s not a backdoor</strong> … but <strong>we don’t know</strong>, we never will and honestly it’s just a stupid and pointless waste of time discussing about it further.</p>
<h3 id="Usability-Really"><a href="#Usability-Really" class="headerlink" title="Usability? Really?"></a>Usability? Really?</h3><p>But the point is, <strong>why implementing e2e encryption in the first place if when keys do not match what expected, the client transmits the message anyway?</strong> Usability? <strong>The usability of what</strong>? Because E2E encryption is <strong>not</strong> usable that way, the client itself might be, but definitely not the underlying protocol which should guarantee the users privacy <strong>on top of everything else</strong>.</p>
<p>Moreover, do you really expect the average whatsapp user to understand what that yellow baloon means if you don’t clearly block the conversation and warn him about what happened? Is this usability? COME ON!</p>
<p>I think Moxie just missed the point, which is <strong>not</strong> they key being changed, but the client retransmitting the message regardless!<br>I used to respect him for his life-long battle for privacy, but reading his post it’s quite clear how his opinion is biased towards Facebook.</p>
<center><br><blockquote class="twitter-tweet" data-conversation="none" data-lang="it"><p lang="en" dir="ltr">.<a href="https://twitter.com/guardian" target="_blank" rel="external">@guardian</a> Whisper Systems comes to Facebook/WhatsApp&#39;s defense on its own blog honestly not understanding the problem. Wow. <a href="https://t.co/6EZ0K9Xcle" target="_blank" rel="external">https://t.co/6EZ0K9Xcle</a></p>&mdash; Nadim Kobeissi (@kaepora) <a href="https://twitter.com/kaepora/status/820028708803088385" target="_blank" rel="external">13 gennaio 2017</a></blockquote><br><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script><br></center>

<h3 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h3><p>I’m not a cryptographer of a crypto expert of any kind, but I’ve spent quite a few years working on MITM attacks and tools, I’m well aware how easy it is for <strong>anyone</strong> to exploit the information you leak on a network, and I’m well aware that state sponsored attackers have trillions of other ways to do that more easily and transparently (for the user of course) … we should just stop the drama about it being a backdoor or not and focus on what really matters:</p>
<p><strong>It is definitely a serious security issue for the users privacy and Facebook refused to fix it</strong>.</p>
<p>There’s really nothing more than that to say.</p>

      
      
      <hr/>
      <center>

        <div style="font-size:16px;margin:0 auto;width:300px" class="blockchain-btn"
        data-address="16xFm5NrKV6eEV4TTDEUdkjqe62L352apW"
        data-shared="false">
        <div class="blockchain stage-begin">
        <img src="https://blockchain.info/Resources/buttons/donate_64.png"/>
        </div>
        <div class="blockchain stage-loading" style="text-align:center">
        <img src="https://blockchain.info/Resources/loading-large.gif"/>
        </div>
        <div class="blockchain stage-ready">
        <p align="center">Please Donate To Bitcoin Address: <b>[[address]]</b></p>
        <p align="center" class="qr-code"></p>
        </div>
        <div class="blockchain stage-paid">
        Donation of <b>[[value]] BTC</b> Received. Thank You.
        </div>
        <div class="blockchain stage-error">
        <font color="red">[[error]]</font>
        </div>
        </div>

        <p style="font-size:27px">
            Let's stay in touch!
            <br/>
            <a href="https://twitter.com/evilsocket" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @evilsocket</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
        </p>
      </center>
      
    </div>
    <footer class="article-footer">
      
        <a href="https://www.evilsocket.net/2017/01/14/Thoughts-on-WhatsApp-E2E-Encryption-AKA-Security-is-real-only-if-it-s-the-default/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/backdoor/">backdoor</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/end-to-end-encryption/">end to end encryption</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/privacy/">privacy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/the-guardian/">the guardian</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/whatsapp/">whatsapp</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/04/27/Android-Applications-Reversing-101/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Android Applications Reversing 101
        
      </div>
    </a>
  
  
    <a href="/2016/10/09/IoCOFFEE-Reversing-the-Smarter-Coffee-IoT-machine-protocol-to-make-coffee-using-terminal/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Reversing the Smarter Coffee IoT Machine Protocol to Make Coffee Using the Terminal.</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Simone Margaritelli<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4da572964da15ce9" async="async"></script>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/books.html" class="mobile-nav-link">Books</a>
  
    <a href="/random-facts-about-me.html" class="mobile-nav-link">About Me</a>
  
</nav>
    
<script>
  var disqus_shortname = 'evilsocket';
  
  var disqus_url = 'https://www.evilsocket.net/2017/01/14/Thoughts-on-WhatsApp-E2E-Encryption-AKA-Security-is-real-only-if-it-s-the-default/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>