<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>evilsocket / Simone</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="INTP :: Hacker :: I hack stuff.">
<meta property="og:type" content="website">
<meta property="og:title" content="evilsocket &#x2F; Simone">
<meta property="og:url" content="https://www.evilsocket.net/page/5/index.html">
<meta property="og:site_name" content="evilsocket &#x2F; Simone">
<meta property="og:description" content="INTP :: Hacker :: I hack stuff.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="evilsocket &#x2F; Simone">
<meta name="twitter:description" content="INTP :: Hacker :: I hack stuff.">
<meta name="twitter:creator" content="@evilsocket">
<link rel="publisher" href="https://plus.google.com/104794390596458308819">

  <meta name="google-site-verification" content="6qdVG0z0lac2ceITCoTCNm15CPp3K9Sq41_5IK4OLKM">

  
    <link rel="alternate" href="/atom.xml" title="evilsocket / Simone" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-22026549-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
  <script type="text/javascript" src="https://blockchain.info/Resources/js/pay-now-button.js"></script>
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">evilsocket / Simone</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">INTP :: Hacker :: I hack stuff.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/books.html">Books</a>
        
          <a class="main-nav-link" href="/random-facts-about-me.html">About Me</a>
        
      </nav>
      <nav id="sub-nav">
        <a id="nav-github-link" class="nav-icon" href="https://github.com/evilsocket" target="_blank"></a>
        <a id="nav-linkedin-link" class="nav-icon" href="http://it.linkedin.com/in/simonemargaritelli/" target="_blank"></a>
        <a id="nav-twitter-link" class="nav-icon" href="https://twitter.com/evilsocket" target="_blank"></a>
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://www.evilsocket.net"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-back-from-the-grave-vmware-host-clipboard-grabber" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/09/22/back-from-the-grave-vmware-host-clipboard-grabber/">Back From the Grave: VMWare Host Clipboard Grabber</a>
    </h1>
  

      </header>
    
    <br/>
    <div class="article-meta">
      Posted on <time datetime="2014-09-21T23:19:34.000Z" itemprop="datePublished">2014-09-22</time>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>Another post from the past ( 2007, wow time passes so fast :S ), a proof of concept I made to demonstrate how to grab clipboard data of a host machine from within a VMWare guest machine exploiting a backdoored hardware port the vmware team used to … well, I have no clue :D</p>
        
          <p class="article-more-link">
            <a href="/2014/09/22/back-from-the-grave-vmware-host-clipboard-grabber/">Read More</a>
          </p>
        
      
      
    </div>
    <footer class="article-footer">
      
        <a href="https://www.evilsocket.net/2014/09/22/back-from-the-grave-vmware-host-clipboard-grabber/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/2007/">2007</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/clipboard/">clipboard</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/clipboard-grabber/">clipboard grabber</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/exploit/">exploit</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/past/">past</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/poc/">poc</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vmware/">vmware</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-back-from-the-grave-elf32-universal-command-injector" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/17/back-from-the-grave-elf32-universal-command-injector/">Back From the Grave: ELF32 Universal Command Injector</a>
    </h1>
  

      </header>
    
    <br/>
    <div class="article-meta">
      Posted on <time datetime="2014-07-17T13:19:51.000Z" itemprop="datePublished">2014-07-17</time>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>Just a post about a small software I wrote years ago, I don’t want it to be lost.<br>The concept itself was quite simple, you give to it any ELF executable as input and the software will search for space to inject a shellcode of its own, which will execute a custom command.<br>The resulting executable will continue to work as expected, but it will spawn the command wit an <strong>execl</strong> call.</p>
        
          <p class="article-more-link">
            <a href="/2014/07/17/back-from-the-grave-elf32-universal-command-injector/">Read More</a>
          </p>
        
      
      
    </div>
    <footer class="article-footer">
      
        <a href="https://www.evilsocket.net/2014/07/17/back-from-the-grave-elf32-universal-command-injector/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/command/">command</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/elf-command-injection/">elf command injection</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/elf-relocation/">elf relocation</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/elf32/">elf32</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hack/">hack</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/injection/">injection</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-how-telcos-are-bullying-researchers-an-italian-story" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/15/how-telcos-are-bullying-researchers-an-italian-story/">How TELCOs Are Bullying Researchers, an Italian Story.</a>
    </h1>
  

      </header>
    
    <br/>
    <div class="article-meta">
      Posted on <time datetime="2014-07-15T21:22:40.000Z" itemprop="datePublished">2014-07-15</time>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>Those of you following my blog from the beginning, know that I was actively involved in the router hacking scene, mostly during the period in which I wrote the very first implementations of both <a href="https://snipt.net/evilsocket/script-per-il-calcolo-della-chiave-wpa-dei-router-alice-gate-voip-2-plus-wi-fi/" target="_blank" rel="external">Telecom Alice</a> ( and <a href="https://snipt.net/evilsocket/alice-router-unlocker/" target="_blank" rel="external">this</a> ) and <a href="https://snipt.net/evilsocket/script-per-il-calcolo-della-chiave-wpa-dei-router-fastweb-pirelli/" target="_blank" rel="external">Fastweb</a> routers WPA key calculators and unlockers after the <strong>great</strong> reversing job performed by another <a href="http://wifiresearchers.wordpress.com/" target="_blank" rel="external">italian group</a>.<br>Those scripts allowed anyone to unlock hidden services in their routers ( as for the Alice scripts ) and to compute default WPA keys having just basic informations such as mac addresses, etc, demonstrating how broken the end-user security policies were.</p>
<p>Despite the fact I received in the past more than one intimidatory email from representatives of those two companies, I’ve never wrote or talked about that … I was smarter enough to understand that this kind of legal bullshit is better to be ignored, unless you have done something <strong>truly</strong> illegal.</p>
        
          <p class="article-more-link">
            <a href="/2014/07/15/how-telcos-are-bullying-researchers-an-italian-story/">Read More</a>
          </p>
        
      
      
    </div>
    <footer class="article-footer">
      
        <a href="https://www.evilsocket.net/2014/07/15/how-telcos-are-bullying-researchers-an-italian-story/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bullying/">bullying</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/corporate/">corporate</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cyberbullying/">cyberbullying</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/illegal/">illegal</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/law/">law</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/omnitel/">omnitel</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/researcher/">researcher</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/reversing/">reversing</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/router/">router</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/telco/">telco</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/telcos/">telcos</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vodafone/">vodafone</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-why-reinventing-the-wheel-isnt-always-wrong" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/04/21/why-reinventing-the-wheel-isnt-always-wrong/">Why Reinventing the Wheel Isn&#39;t Always Wrong</a>
    </h1>
  

      </header>
    
    <br/>
    <div class="article-meta">
      Posted on <time datetime="2014-04-21T20:11:25.000Z" itemprop="datePublished">2014-04-21</time>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>Recently I was talking with one of my colleagues about computer science and the skills of those who have just taken their degree in Italy. We both agreed that the kind of knowledge you get attending the college is indeed more theoretical than practical ( and trust me, “informatic engineering” courses in Italy colleges are way much more theoretical than CS in the United States ) and most of the times this results in a lot of people with their mouths full of “big words” they don’t really understand.</p>
        
          <p class="article-more-link">
            <a href="/2014/04/21/why-reinventing-the-wheel-isnt-always-wrong/">Read More</a>
          </p>
        
      
      
    </div>
    <footer class="article-footer">
      
        <a href="https://www.evilsocket.net/2014/04/21/why-reinventing-the-wheel-isnt-always-wrong/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-about-redistributing-open-source-apps-dsploit" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/03/25/about-redistributing-open-source-apps-dsploit/">About (Re)distributing Open Source Apps ( dSploit )</a>
    </h1>
  

      </header>
    
    <br/>
    <div class="article-meta">
      Posted on <time datetime="2014-03-24T23:07:53.000Z" itemprop="datePublished">2014-03-25</time>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>It’s a while I see compiled dSploit versions pop up on Google Play Store, most of the times the actual changes are <a href="https://play.google.com/store/apps/details?id=com.number5.netcut" target="_blank" rel="external">just a matter of icons</a>, other times are merely <a href="https://play.google.com/store/apps/details?id=com.anstudios.dsploit" target="_blank" rel="external">compiled versions</a> of one of the nightly releases.</p>
<p>Altough I can not ( and really don’t want to ) avoid this, I’d like to write a few lines about this kind of conduct and the ethics behind open source software.</p>
<p>As most of my personal projects, dSploit was released from the beginning under the <a href="http://www.gnu.org/licenses/quick-guide-gplv3.html" target="_blank" rel="external">GPL 3</a> license, this means that you can modify it at your own will, distribute it for free or even as a paid software and share it with your friends.<br>You are <strong>only</strong> asked to make your changes available under the same license and make references to the original authors of the software itself. That’s it, this is <strong>so</strong> simple.</p>
<p>Beyond the fact I find deeply unfair not putting even the smallest link to the original repository or some credits on the description of those compiled distributions, there are a few things anyone who wants to make such thing should be aware of before blindly cloning the repository and compiling the source code.</p>
        
          <p class="article-more-link">
            <a href="/2014/03/25/about-redistributing-open-source-apps-dsploit/">Read More</a>
          </p>
        
      
      
    </div>
    <footer class="article-footer">
      
        <a href="https://www.evilsocket.net/2014/03/25/about-redistributing-open-source-apps-dsploit/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dsploit/">dsploit</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gpl/">gpl</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gplv3/">gplv3</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/license/">license</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/play-store/">play store</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/projects/">projects</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/store/">store</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-programmatically-identifying-and-isolating-functions-inside-executables-like-ida-does" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/03/11/programmatically-identifying-and-isolating-functions-inside-executables-like-ida-does/">Programmatically Identifying and Isolating Functions Inside Executables Like IDA Does.</a>
    </h1>
  

      </header>
    
    <br/>
    <div class="article-meta">
      Posted on <time datetime="2014-03-11T22:50:48.000Z" itemprop="datePublished">2014-03-11</time>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>Even though it’s one of the tools I use on a daily basis, Hex-Rays <strong><a href="https://www.hex-rays.com/products/ida/" target="_blank" rel="external">IDA</a></strong> always fascinates me for its completeness and the huge amount of informations it is able to extract using just a “simple” static analysis approach and being myself a <em>“make yourself the tools you need”</em> guy a couple of weeks ago I’ve started to study it, trying to understand its internal mechanisms, algorithms and tricks.</p>
<p>I’ve focused on the identification and isolation of subroutines inside an executable due to the fact that this seemed to me the simplest thing to start with <strong>and</strong> because I came accross <a href="http://blog.clamav.net/2014/02/generating-clamav-signatures-with.html" target="_blank" rel="external">this blog post</a> that shows how great IDA python libraries are.</p>
        
          <p class="article-more-link">
            <a href="/2014/03/11/programmatically-identifying-and-isolating-functions-inside-executables-like-ida-does/">Read More</a>
          </p>
        
      
      
    </div>
    <footer class="article-footer">
      
        <a href="https://www.evilsocket.net/2014/03/11/programmatically-identifying-and-isolating-functions-inside-executables-like-ida-does/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/distorm/">distorm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/functions/">functions</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ida/">ida</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/libpe/">libpe</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/reversing/">reversing</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/routines/">routines</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/static-analysis/">static analysis</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/subroutines/">subroutines</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-libpe-a-fast-pe32pe32-parsing-library" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/02/21/libpe-a-fast-pe32pe32-parsing-library/">Libpe - a Fast PE32/PE32+ Parsing Library.</a>
    </h1>
  

      </header>
    
    <br/>
    <div class="article-meta">
      Posted on <time datetime="2014-02-21T17:19:57.000Z" itemprop="datePublished">2014-02-21</time>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>I’ve just published on <a href="https://github.com/evilsocket/libpe" target="_blank" rel="external">github</a> <strong>libpe</strong>, a C/C++ library to parse Windows portable executables ( both PE32 and PE32+ ) written with <strong>speed</strong> and <strong>stability</strong> in mind, released under the GPL 3 license.<br>Currently the library is released as a Microsoft Visual Studio solution containing the library itself and an <a href="https://github.com/evilsocket/libpe/blob/master/peview/peview.cpp" target="_blank" rel="external">example project</a>, I will make it cross platform in future releases.</p>
        
          <p class="article-more-link">
            <a href="/2014/02/21/libpe-a-fast-pe32pe32-parsing-library/">Read More</a>
          </p>
        
      
      
    </div>
    <footer class="article-footer">
      
        <a href="https://www.evilsocket.net/2014/02/21/libpe-a-fast-pe32pe32-parsing-library/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/">c</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/c/">c++</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/libpe/">libpe</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/library/">library</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/open-source/">open source</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/parsing/">parsing</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pe32/">pe32</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pe32/">pe32+</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/portable-executable/">portable executable</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/projects/">projects</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-on-windows-syscall-mechanism-and-syscall-numbers-extraction-methods" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/02/11/on-windows-syscall-mechanism-and-syscall-numbers-extraction-methods/">On Windows Syscall Mechanism and Syscall Numbers Extraction Methods</a>
    </h1>
  

      </header>
    
    <br/>
    <div class="article-meta">
      Posted on <time datetime="2014-02-11T14:28:00.000Z" itemprop="datePublished">2014-02-11</time>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>Everyone who’s familiar with operating systems theoretical structure, whether he attented a college course or he has just read a book on this subject, knows the concept of a <strong>system call</strong> i.e. how a user space application talks with the kernel asking it to perform various jobs such as opening a file, creating a memory mapped region, etc.</p>
        
          <p class="article-more-link">
            <a href="/2014/02/11/on-windows-syscall-mechanism-and-syscall-numbers-extraction-methods/">Read More</a>
          </p>
        
      
      
    </div>
    <footer class="article-footer">
      
        <a href="https://www.evilsocket.net/2014/02/11/on-windows-syscall-mechanism-and-syscall-numbers-extraction-methods/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/int-2e/">int 2e</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/intel/">intel</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/interrupt/">interrupt</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/microsoft/">microsoft</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ntdll/">ntdll</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/peb/">peb</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/reversing/">reversing</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/syscall/">syscall</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sysenter/">sysenter</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tib/">tib</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/windows/">windows</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/windows-internals/">windows internals</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wow64/">wow64</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-termination-and-injection-self-defense-on-windows" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/02/05/termination-and-injection-self-defense-on-windows/">Termination and Injection Self Defense on Windows &gt;= Vista SP1</a>
    </h1>
  

      </header>
    
    <br/>
    <div class="article-meta">
      Posted on <time datetime="2014-02-05T21:08:04.000Z" itemprop="datePublished">2014-02-05</time>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>On a <a href="/2014/02/01/keservicedescriptortable-patching-aka-how-to-hook-win32-api-patching-the-kernel/">previous post</a> I’ve talked about how to perform API hooking at kernel level on 32bit Windows systems to prevent a process from being terminated.<br>Today I’m gonna talk about <a href="http://msdn.microsoft.com/en-us/library/windows/hardware/ff557759(v=vs.85" target="_blank" rel="external">OBR and callbacks</a>.aspx), mainly to show how to achieve the same result on 64bit systems starting from Vista SP1 and later.</p>
        
          <p class="article-more-link">
            <a href="/2014/02/05/termination-and-injection-self-defense-on-windows/">Read More</a>
          </p>
        
      
      
    </div>
    <footer class="article-footer">
      
        <a href="https://www.evilsocket.net/2014/02/05/termination-and-injection-self-defense-on-windows/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ObRegisterCallbacks/">ObRegisterCallbacks</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Windows/">Windows</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/api-hooking/">api hooking</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/driver/">driver</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kernel/">kernel</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/memory-injection/">memory injection</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/obcallbacks/">obcallbacks</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/process-protection/">process protection</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/security/">security</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/self-protection/">self protection</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-process-introspection-for-fun-and-profit" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/02/02/process-introspection-for-fun-and-profit/">Process Introspection for Fun and Profit</a>
    </h1>
  

      </header>
    
    <br/>
    <div class="article-meta">
      Posted on <time datetime="2014-02-02T02:17:24.000Z" itemprop="datePublished">2014-02-02</time>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>While studying Windows internals for my job, I had to  deepen my knowledge of executable loading process, including their memory layout, address relocations and so on.<br>I came accross the <strong>PEB</strong> ( process environment block ), a data structure ( mostly undocumented ) that NT systems use internally to handle many aspects of a process, including a list of loaded libraries, environment variables, command line arguments, heap informations, TLS slots and so on.<br>The interesting fact about the PEB is that can be inspected to obtain those informations without the use of any standard API, thus resulting in an interesting technique to detect bad written virtual machines, emulators and any sort of sandboxing that could be used by a malware analyst or an anti virus product.<br>Moreover you could check the PEB to detect if a DLL has been injected into your process to perform api hooking.<br>API hooking softwares usually hooks API such as <strong>EnumProcessModules</strong> and patch them to hide the presence of the injected module. Inspecting the PEB you will be able to perform the same task only analyzing your address space, thus avoiding API patching.</p>
        
          <p class="article-more-link">
            <a href="/2014/02/02/process-introspection-for-fun-and-profit/">Read More</a>
          </p>
        
      
      
    </div>
    <footer class="article-footer">
      
        <a href="https://www.evilsocket.net/2014/02/02/process-introspection-for-fun-and-profit/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/api-hooking/">api hooking</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/emulator/">emulator</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/evasion/">evasion</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hooking/">hooking</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ldr/">ldr</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/loader/">loader</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/malware/">malware</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pe/">pe</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/process-environment-block/">process environment block</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tib/">tib</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vm/">vm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/win32/">win32</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/page/4/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/6/">Next &raquo;</a>
  </nav>

</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Simone Margaritelli<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4da572964da15ce9" async="async"></script>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/books.html" class="mobile-nav-link">Books</a>
  
    <a href="/random-facts-about-me.html" class="mobile-nav-link">About Me</a>
  
</nav>
    
<script>
  var disqus_shortname = 'evilsocket';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>