<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Autopwn Every Android &lt; 4.2 Device on Your Network Using BetterCap and the addJavascriptInterface Vulnerability. | evilsocket / Simone</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Recently I’ve been playing with Android’s WebView based vulnerabilities, focusing on how to exploit them using a MITM attack.One of the most interesting ones is the addJavascriptInterface vulnerabilit">
<meta name="keywords" content="android,bettercap,hack,hacking,transparent proxy,addJavascriptInterface,proxy,vulnerability">
<meta property="og:type" content="article">
<meta property="og:title" content="Autopwn Every Android &lt; 4.2 Device on Your Network Using BetterCap and the addJavascriptInterface Vulnerability.">
<meta property="og:url" content="https://www.evilsocket.net/2016/01/18/autopwn-every-android-device-on-your-network-using-bettercap-the-and-addjavascriptinterface-vulnerability/index.html">
<meta property="og:site_name" content="evilsocket &#x2F; Simone">
<meta property="og:description" content="Recently I’ve been playing with Android’s WebView based vulnerabilities, focusing on how to exploit them using a MITM attack.One of the most interesting ones is the addJavascriptInterface vulnerabilit">
<meta property="og:image" content="https://www.evilsocket.net/images/2016/01/hacked.jpg">
<meta property="og:image" content="https://www.evilsocket.net/images/2016/01/androidpwn-1.png">
<meta property="og:updated_time" content="2017-08-11T14:28:47.028Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Autopwn Every Android &lt; 4.2 Device on Your Network Using BetterCap and the addJavascriptInterface Vulnerability.">
<meta name="twitter:description" content="Recently I’ve been playing with Android’s WebView based vulnerabilities, focusing on how to exploit them using a MITM attack.One of the most interesting ones is the addJavascriptInterface vulnerabilit">
<meta name="twitter:image" content="https://www.evilsocket.net/images/2016/01/hacked.jpg">
<meta name="twitter:creator" content="@evilsocket">
<link rel="publisher" href="https://plus.google.com/104794390596458308819">

  <meta name="google-site-verification" content="6qdVG0z0lac2ceITCoTCNm15CPp3K9Sq41_5IK4OLKM">

  
    <link rel="alternate" href="/atom.xml" title="evilsocket / Simone" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-22026549-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
  <script type="text/javascript" src="https://blockchain.info/Resources/js/pay-now-button.js"></script>
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">evilsocket / Simone</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">I hack stuff.</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/books.html">Books</a>
        
          <a class="main-nav-link" href="/random-facts-about-me.html">About Me</a>
        
      </nav>
      <nav id="sub-nav">
        <a id="nav-github-link" class="nav-icon" href="https://github.com/evilsocket" target="_blank"></a>
        <a id="nav-linkedin-link" class="nav-icon" href="http://it.linkedin.com/in/simonemargaritelli/" target="_blank"></a>
        <a id="nav-twitter-link" class="nav-icon" href="https://twitter.com/evilsocket" target="_blank"></a>
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://www.evilsocket.net"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-autopwn-every-android-device-on-your-network-using-bettercap-the-and-addjavascriptinterface-vulnerability" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Autopwn Every Android &lt; 4.2 Device on Your Network Using BetterCap and the addJavascriptInterface Vulnerability.
    </h1>
  

      </header>
    
    <br/>
    <div class="article-meta">
      Posted on <time datetime="2016-01-18T19:27:40.000Z" itemprop="datePublished">2016-01-18</time>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <br/>
        <div class="addthis_sharing_toolbox"></div>
        <p>Recently I’ve been playing with Android’s WebView based vulnerabilities, focusing on how to exploit them using a MITM attack.<br>One of the most interesting ones is the <strong>addJavascriptInterface</strong> vulnerability ( <a href="http://www.cvedetails.com/cve/2012-6636" target="_blank" rel="external">CVE-2012-6636</a> ) which affects every device running a version older than Android 4.2.</p>
<a id="more"></a>
<p><strong>NOTE</strong></p>
<p>The original title of this post was <strong>Autopwn every Android device on your network using BetterCap and the “addJavascriptInterface” vulnerability</strong> and some people pointed out it’s a misleading title since “<strong>every Android != every Android &lt; 4.2</strong>“. I totally agree with them, it wasn’t intentional, the point of this post itself was not to show some uber 0day technique, but just to show how easy it is to use bettercap in order to exploit such type of vulnerabilities.</p>
<p><img src="/images/2016/01/hacked.jpg" alt="hacked"></p>
<p>There’s an <a href="https://labs.mwrinfosecurity.com/blog/2013/09/24/webview-addjavascriptinterface-remote-code-execution/" target="_blank" rel="external">excellent post</a> about this vulnerability, long story short, if there’s an app which is using a <strong>WebView</strong> UI control and it’s declaring a custom javascript interface for it like so:</p>
<script src="https://gist.github.com/evilsocket/4f4deb1dbd1d66519dba.js"></script>

<p>you can inject some special javascript into that page and make that device execute any shell command you want.</p>
<p>In this post, I’d like to show how easy it is to automatically exploit every vulnerable device on your network using <a href="http://www.bettercap.org/" target="_blank" rel="external">bettercap</a> and for this purpose I’ve wrote the <a href="https://github.com/evilsocket/bettercap-proxy-modules/blob/master/androidpwn.rb" target="_blank" rel="external">AndroidPwn</a> transparent proxy module.</p>
<script src="https://gist.github.com/evilsocket/2e91719839d3fd6b06d6.js"></script>

<p>As you can see, you just need to activate it and specify a <code>--command COMMAND</code> command line argument and you’re ready to go.</p>
<p><img src="/images/2016/01/androidpwn-1.png" alt="androidpwn"></p>
<p>Leave it running and it will automatically perform a Man-In-The-Middle attack on your network and execute the command(s) you’ve chosen on every single Android device it will find on the network.</p>

      
      
      <hr/>
      <center>

        <div style="font-size:16px;margin:0 auto;width:300px" class="blockchain-btn"
        data-address="16xFm5NrKV6eEV4TTDEUdkjqe62L352apW"
        data-shared="false">
        <div class="blockchain stage-begin">
        <img src="https://blockchain.info/Resources/buttons/donate_64.png"/>
        </div>
        <div class="blockchain stage-loading" style="text-align:center">
        <img src="https://blockchain.info/Resources/loading-large.gif"/>
        </div>
        <div class="blockchain stage-ready">
        <p align="center">Please Donate To Bitcoin Address: <b>[[address]]</b></p>
        <p align="center" class="qr-code"></p>
        </div>
        <div class="blockchain stage-paid">
        Donation of <b>[[value]] BTC</b> Received. Thank You.
        </div>
        <div class="blockchain stage-error">
        <font color="red">[[error]]</font>
        </div>
        </div>

        <p style="font-size:27px">
            Let's stay in touch!
            <br/>
            <a href="https://twitter.com/evilsocket" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @evilsocket</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
        </p>
      </center>
      
    </div>
    <footer class="article-footer">
      
        <a href="https://www.evilsocket.net/2016/01/18/autopwn-every-android-device-on-your-network-using-bettercap-the-and-addjavascriptinterface-vulnerability/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/addJavascriptInterface/">addJavascriptInterface</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/android/">android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bettercap/">bettercap</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hack/">hack</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hacking/">hacking</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/proxy/">proxy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/transparent-proxy/">transparent proxy</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/vulnerability/">vulnerability</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/01/28/why-you-shouldnt-trust-cloudflares-flexible-ssl-and-how-to-bypass-it-with-bettercap/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Why You Shouldn&#39;t Trust CloudFlare&#39;s &#39;Flexible SSL&#39; and How to Bypass It With BetterCap
        
      </div>
    </a>
  
  
    <a href="/2016/01/10/bettercap-and-the-first-real-icmp-redirect-attack/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">BetterCap and the First REAL DoubleDirect ICMP Redirect Attack</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>

</section>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Simone Margaritelli<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4da572964da15ce9" async="async"></script>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/books.html" class="mobile-nav-link">Books</a>
  
    <a href="/random-facts-about-me.html" class="mobile-nav-link">About Me</a>
  
</nav>
    
<script>
  var disqus_shortname = 'evilsocket';
  
  var disqus_url = 'https://www.evilsocket.net/2016/01/18/autopwn-every-android-device-on-your-network-using-bettercap-the-and-addjavascriptinterface-vulnerability/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>